Eyoucms 1.3.9 上传漏洞
======================

一、漏洞简介
------------

EyouCms是基于TP5.0框架为核心开发的免费+开源的企业内容管理系统，专注企业建站用户需求提供海量各行业模板，降低中小企业网站建设、网络营销成本，致力于打造用户舒适的建站体验。易优cms
v1.3.7后台插件模块存在代码执

二、漏洞影响
------------

Weapp.php文件中的create()方法接收了请求中的参数，过滤后直接存入php配置文件中，但是由于过滤不严，导致可以直接写入代码进去并执行。

三、复现过程
------------

### 1、登陆后台

在后台\-\-\-\--》插件应用\-\-\-\--》上传插件这里可以上传zip文件

![](./resource/Eyoucms1.3.9上传漏洞/media/rId25.png)

在Weapp.php文件中的upload()方法中可以上传zip文件，并会自动解压到一个文件夹名是随机md5值的文件夹下

在后台开启插件功能，上传zip文件，zip中有php一句话木马以及一个任意图片(图片内容无所谓，正常图片即可，但是必须得有)

上传后，虽然会返回错误信息，但是实际上后台已经解压了zip文件

访问内容管理模块，任意选择一个产品进行编辑，再图片集处可以上传图片，选择在线管理，可以在左侧看到该文件夹名

直接访问该文件夹下的php一句话木马文件即可

![](./resource/Eyoucms1.3.9上传漏洞/media/rId26.png)
